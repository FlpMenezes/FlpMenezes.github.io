---
title: "Relatório 08"
author: "Felipe Henrique"
date: "05/06/2025"
header-includes:
  - \usepackage{titling}
  - \pretitle{\begin{center}
    \includegraphics[width=2in,height=2in]{ufsj.png}\LARGE\\}
  - \posttitle{\end{center}}
toc-title: "Sumário"
output:
  
  html_document:
    theme: journal
    highlight: tango
    toc: yes
    number_sections: yes
    includes:
      in_header: logo.html
  pdf_document:
    
    toc: yes
    number_sections: yes
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


# Objetivo

```{r, carregando-pacotes, message=FALSE, warning=FALSE}
# Pacotes necessários
library(ggplot2)
library(car)
library(nortest)
library(lmtest)
library(ExpDes.pt)

# 1. Base de dados
dados <- data.frame(
  Corrente = rep(1:5, each = 3),
  Dissipacao = c(2.10, 2.30, 2.20,
                 4.40, 4.50, 4.30,
                 6.60, 6.70, 6.50,
                 8.90, 9.00, 9.10,
                 11.30, 11.20, 11.50)
)

# 2. ANOVA com análise de regressão via ExpDes.pt
reganava <- dic(trat = dados$Corrente,
                resp = dados$Dissipacao,
                quali = FALSE)  # Corrente é quantitativo

# 3. Coeficientes da regressão linear (reta)
# São extraídos diretamente do modelo linear:
modelo <- lm(Dissipacao ~ Corrente, data = dados)
summary(modelo)

# 4. Gráfico com reta ajustada
ggplot(dados, aes(x = Corrente, y = Dissipacao)) +
  geom_point(size = 3, color = "steelblue") +
  geom_smooth(method = "lm", se = FALSE, color = "darkred") +
  labs(title = "Dissipação Térmica vs Corrente",
       x = "Corrente (A)",
       y = "Dissipação Térmica (W)") +
  theme_minimal()

# 5. Diagnóstico dos resíduos

# 5.1. Teste de normalidade
residuos <- residuals(modelo)
shapiro.test(residuos)

# 5.2. Homogeneidade das variâncias
bartlett.test(Dissipacao ~ Corrente, data = dados)

# 5.3. Independência dos resíduos
durbinWatsonTest(modelo)

# 5.4. Gráfico de resíduos
plot(modelo, which = 1)

# 6. Estimativa para Corrente = 3,5 A
predict(modelo, newdata = data.frame(Corrente = 3.5), interval = "prediction")

# 7. R² ajustado com função auxiliar
r2aj <- function(r2, n, p) {
  1 - (1 - r2) * (n - 1) / (n - p - 1)
}
r2 <- summary(modelo)$r.squared
n <- nrow(dados)
p <- length(coef(modelo)) - 1
r2ajustado <- r2aj(r2, n, p)
r2ajustado

```

